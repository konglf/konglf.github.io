

<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Lingfei&#39;s Blog</title>
  <meta name="author" content="Lingfei Kong">
  
  <meta name="description" content="读书笔记，资料整理">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  
  <meta property="og:site_name" content="Lingfei&#39;s Blog"/>

  
    <meta property="og:image" content="undefined"/>
  

  <link href="/favicon.ico" rel="icon" type="image/x-ico">
  <link rel="alternate" href="http://kongll.github.io/atom.xml" title="Lingfei&#39;s Blog" type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8/jquery.min.js"></script>
  <script type="text/javascript">
var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3Ffe3814b5f53cc394a493cbeb2368f2af' type='text/javascript'%3E%3C/script%3E"));
</script>



</head>


<body>
  <header id="header" class="inner">
<div class="alignleft">
  <h1><a href="/">Lingfei&#39;s Blog</a></h1>
  <h2><a href="/">我要扼住命运的咽喉，决不能让命运使我屈服</a></h2>
</div>
<nav id="main-nav" class="alignright">
  <ul>
    
      <li><a href="/">首页</a></li>
    
      <li><a href="/categories/Technology">技术</a></li>
    
      <li><a href="/categories/essay">随笔</a></li>
    
      <li><a href="/archives">归档</a></li>
    
      <li><a href="/about">关于</a></li>
    
	<li> <a href="/atom.xml">RSS</a> </li>
<li> <a title="把这个链接拖到你的Chrome收藏夹工具栏中" href='javascript:(function() {
	function c() {
		var e = document.createElement("link");
		e.setAttribute("type", "text/css");
		e.setAttribute("rel", "stylesheet");
		e.setAttribute("href", f);
		e.setAttribute("class", l);
		document.body.appendChild(e)
	}
 
	function h() {
		var e = document.getElementsByClassName(l);
		for (var t = 0; t < e.length; t++) {
			document.body.removeChild(e[t])
		}
	}
 
	function p() {
		var e = document.createElement("div");
		e.setAttribute("class", a);
		document.body.appendChild(e);
		setTimeout(function() {
			document.body.removeChild(e)
		}, 100)
	}
 
	function d(e) {
		return {
			height : e.offsetHeight,
			width : e.offsetWidth
		}
	}
 
	function v(i) {
		var s = d(i);
		return s.height > e && s.height < n && s.width > t && s.width < r
	}
 
	function m(e) {
		var t = e;
		var n = 0;
		while (!!t) {
			n += t.offsetTop;
			t = t.offsetParent
		}
		return n
	}
 
	function g() {
		var e = document.documentElement;
		if (!!window.innerWidth) {
			return window.innerHeight
		} else if (e && !isNaN(e.clientHeight)) {
			return e.clientHeight
		}
		return 0
	}
 
	function y() {
		if (window.pageYOffset) {
			return window.pageYOffset
		}
		return Math.max(document.documentElement.scrollTop, document.body.scrollTop)
	}
 
	function E(e) {
		var t = m(e);
		return t >= w && t <= b + w
	}
 
	function S() {
		var e = document.createElement("audio");
		e.setAttribute("class", l);
		e.src = i;
		e.loop = false;
		e.addEventListener("canplay", function() {
			setTimeout(function() {
				x(k)
			}, 500);
			setTimeout(function() {
				N();
				p();
				for (var e = 0; e < O.length; e++) {
					T(O[e])
				}
			}, 15500)
		}, true);
		e.addEventListener("ended", function() {
			N();
			h()
		}, true);
		e.innerHTML = " <p>If you are reading this, it is because your browser does not support the audio element. We recommend that you get a new browser.</p> <p>";
		document.body.appendChild(e);
		e.play()
	}
 
	function x(e) {
		e.className += " " + s + " " + o
	}
 
	function T(e) {
		e.className += " " + s + " " + u[Math.floor(Math.random() * u.length)]
	}
 
	function N() {
		var e = document.getElementsByClassName(s);
		var t = new RegExp("\\b" + s + "\\b");
		for (var n = 0; n < e.length; ) {
			e[n].className = e[n].className.replace(t, "")
		}
	}
 
	var e = 30;
	var t = 30;
	var n = 350;
	var r = 350;
	var i = "//s3.amazonaws.com/moovweb-marketing/playground/harlem-shake.mp3";
	var s = "mw-harlem_shake_me";
	var o = "im_first";
	var u = ["im_drunk", "im_baked", "im_trippin", "im_blown"];
	var a = "mw-strobe_light";
	var f = "//s3.amazonaws.com/moovweb-marketing/playground/harlem-shake-style.css";
	var l = "mw_added_css";
	var b = g();
	var w = y();
	var C = document.getElementsByTagName("*");
	var k = null;
	for (var L = 0; L < C.length; L++) {
		var A = C[L];
		if (v(A)) {
			if (E(A)) {
				k = A;
				break
			}
		}
	}
	if (A === null) {
		console.warn("Could not find a node of the right size. Please try a different page.");
		return
	}
	c();
	S();
	var O = [];
	for (var L = 0; L < C.length; L++) {
		var A = C[L];
		if (v(A)) {
			O.push(A)
		}
	}
})()    '>High一下</a> </li>

  </ul>
  <div class="clearfix"></div>
</nav>
<div class="clearfix"></div></header>
  <div id="content" class="inner">
    <div id="main-col" class="alignleft"><div id="wrapper">
  <article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2015-07-09T17:11:10.000Z"><a href="/2015/07/10/hello-world/">2015-07-10</a></time>
      
      
  
    <h1 class="title"><a href="/2015/07/10/hello-world/">Hello World</a></h1>
  

    </header>
    <div class="entry">
      
        <p>Welcome to <a href="http://hexo.io/" target="_blank" rel="external">Hexo</a>! This is your very first post. Check <a href="http://hexo.io/docs/" target="_blank" rel="external">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="http://hexo.io/docs/troubleshooting.html" target="_blank" rel="external">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="external">GitHub</a>.</p>
<h2 id="Quick_Start">Quick Start</h2><h3 id="Create_a_new_post">Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">"My New Post"</span></span><br></pre></td></tr></table></figure>
<p>More info: <a href="http://hexo.io/docs/writing.html" target="_blank" rel="external">Writing</a></p>
<h3 id="Run_server">Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>
<p>More info: <a href="http://hexo.io/docs/server.html" target="_blank" rel="external">Server</a></p>
<h3 id="Generate_static_files">Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>
<p>More info: <a href="http://hexo.io/docs/generating.html" target="_blank" rel="external">Generating</a></p>
<h3 id="Deploy_to_remote_sites">Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>
<p>More info: <a href="http://hexo.io/docs/deployment.html" target="_blank" rel="external">Deployment</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>





  <article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2015-04-24T00:35:18.000Z"><a href="/2015/04/24/bonnie/">2015-04-24</a></time>
      
      
  
    <h1 class="title"><a href="/2015/04/24/bonnie/">bonnie++</a></h1>
  

    </header>
    <div class="entry">
      
        <h1 id="How_to_install_bonnie++">How to install bonnie++</h1><ol>
<li><p>Download bonnie++ tarball from <a href="http://www.coker.com.au/bonnie++/" target="_blank" rel="external">http://www.coker.com.au/bonnie++/</a></p>
</li>
<li><p>Extract and install it:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># tar -xvzf bonnie++-<span class="doctag">XXX.</span>tgz</span></span><br><span class="line"><span class="comment"># cd bonnie++-<span class="doctag">XXX</span></span></span><br><span class="line"><span class="comment"># make</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<h1 id="Features_and_Functions">Features and Functions</h1><ul>
<li>Easy to use, a simple tool used to test your hard drive and file system performance.</li>
<li>Can test the following I/O operations:<ul>
<li>Sequential Output<ul>
<li>Per Chr</li>
<li>Block</li>
<li>Rewrite</li>
</ul>
</li>
<li>Sequential Input<ul>
<li>Per Chr</li>
<li>Block</li>
</ul>
</li>
<li>Random<ul>
<li>Seeks</li>
</ul>
</li>
<li>Sequential Create<ul>
<li>Create</li>
<li>Read</li>
<li>Delete</li>
</ul>
</li>
<li>Random Create<ul>
<li>Create</li>
<li>Read</li>
<li>Delete</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>Bonnie++ is a program to test hard drives and file systems for performance or the lack therof. There are a many different types of file system operations which different applications use to different degrees. Bonnie++ tests some of them and for each test gives a result of the amount of work done per second and the percentage of CPU time this took. For performance results higher numbers are better, for CPU usage lower are better (NB a configuration scoring a performance result of 2000 and a  CPU result of 90% is better in terms of CPU use than a configuration delivering performance of 1000 and CPU usage of 60%).</p>
<p>There are two sections to the program’s operations. The first is to test the IO throughput in a fashion that is designed to simulate some types of database applications. The second is to test creation, reading, and deleting many small files in a fashion similar to the usage patterns of programs such as Squid or INN.</p>
<h1 id="How_to_use_bonnie++">How to use bonnie++</h1><p>Just issue the following command, it should be ok for most situations:<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># bonnie++ -d /testdir/ -m testname -u root -s $((2*$RAM_SIZE))</span></span><br></pre></td></tr></table></figure></p>
<p><strong>Note:</strong><br>If you test want to test hard drive, you must mount it to the value of <strong>-d</strong> option. Also make sure that the hard drive size is double RAM, or you will have to specify <strong>-r</strong> option.</p>
<p>If you want to reduce ‘++++’ you need to increase the test time either by increasing the value of <strong>-n</strong> or by increasing the value of <strong>-s</strong>.</p>
<h1 id="Results_analysis">Results analysis</h1><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># bonnie++ -d ./ -m testname -u root -s 40M -r 10M</span></span><br><span class="line">Using uid:<span class="number">0</span>, gid:<span class="number">0</span>.</span><br><span class="line">Writing with putc()...done</span><br><span class="line">Writing intelligently...done</span><br><span class="line">Rewriting...done</span><br><span class="line">Reading with getc()...done</span><br><span class="line">Reading intelligently...done</span><br><span class="line">start <span class="string">'em...done...done...done...</span><br><span class="line">Create files in sequential order...done.</span><br><span class="line">Stat files in sequential order...done.</span><br><span class="line">Delete files in sequential order...done.</span><br><span class="line">Create files in random order...done.</span><br><span class="line">Stat files in random order...done.</span><br><span class="line">Delete files in random order...done.</span><br><span class="line">Version 1.03e       ------Sequential Output------ --Sequential Input- --Random-</span><br><span class="line">                    -Per Chr- --Block-- -Rewrite- -Per Chr- --Block-- --Seeks--</span><br><span class="line">Machine        Size K/sec %CP K/sec %CP K/sec %CP K/sec %CP K/sec %CP  /sec %CP</span><br><span class="line">testname        40M 54715  99 +++++ +++ +++++ +++ 51914  99 +++++ +++ +++++ +++</span><br><span class="line">                    ------Sequential Create------ --------Random Create--------</span><br><span class="line">                    -Create-- --Read--- -Delete-- -Create-- --Read--- -Delete--</span><br><span class="line">              files  /sec %CP  /sec %CP  /sec %CP  /sec %CP  /sec %CP  /sec %CP</span><br><span class="line">                 16 15104  99 +++++ +++ +++++ +++ 15480  99 +++++ +++ 31050  95</span><br><span class="line">testname,40M,54715,99,+++++,+++,+++++,+++,51914,99,+++++,+++,+++++,+++,16,15104,99,+++++,+++,+++++,+++,15480,99,+++++,+++,31050,95</span></span><br></pre></td></tr></table></figure>
<p>The primary output is plain-text in 80 columns which is designed to fit well when pasted into email and which will work well with Braille displays.</p>
<p>The second type of output is CSV (Comma Seperated Values). This can easily be imported into any spread-sheet or database program. Also it have included the programs bon_csv2html and bon_csv2txt to convert CSV data to HTML and plain-ascii respectively:</p>
<ol>
<li><p>Select the last comma seperated line.</p>
</li>
<li><p>Run the following command to generate the html file:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">'testname,40M,54715,99,+++++,+++,+++++,+++,51914,99,+++++,+++,+++++,+++,16,15104,99,+++++,+++,+++++,+++,15480,99,+++++,+++,31050,95'</span> | perl bon_csv2html &gt; results.html</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>For every test two numbers are reported, the amount of work done (higher numbers are better) and the percentage of CPU time taken to perform the work (lower numbers are better). If a test  completes in less than 500ms then the output will be displayed as “++++”. This is because such a test result can’t be calculated accurately due to rounding errors and I would rather display no result than a wrong result.</p>
<h1 id="The_main_parameters">The main parameters</h1><ul>
<li><strong>-d</strong> - the directory to use for the tests.</li>
<li><strong>-s</strong> - the size of the file(s) for IO performance measures in megabytes. If the size is greater than 1G then multiple files will be used to store the data, and each file will be up to 1G in size. This parameter may include the chunk size seperated from the size by a colon. The chunk-size is measured in bytes and must be a power of two from 256 to 1048576, the default is 8192. You can specify the size in giga-bytes or the chunk-size in kilo-bytes if you add g or k to the end of the number respectively.</li>
<li><strong>-r</strong> - RAM size in megabytes. If you specify this the other parameters will be checked to ensure they make sense for a machine of that much RAM. You should not need to do this in general use as it should be able to discover the RAM size. NB If you specify a size of 0 then all checks will be disabled…</li>
<li><strong>-b</strong> - no write buffering. fsync() after every write.</li>
<li><strong>-D</strong> - use direct IO (O_DIRECT) for the bulk IO tests.</li>
<li><strong>-n</strong> - the number of files for the file creation test. This is measured in multiples of 1024 files. This is because no-one will want to test less than 1024 files, and we need the extra space on braille displays.</li>
<li><strong>-x</strong> - number of test runs. This is useful if you want to perform more than one test. It will dump output continuously in CSV format until either the number of tests have been completed, or it is killed.</li>
<li><strong>-m</strong> - name of the machine - for display purposes only.</li>
<li><strong>-f</strong> - fast mode, skips per-char IO tests</li>
<li><strong>-u</strong> - user-id to use. When running as root specify the UID to use for the tests. It is not recommended to use root (since the occasion when a Bonnie++ bug wiped out someone’s system), so if you really want to run as root then use -u root. Also if you want to specify the group to run as then use the user:group format. If you specify a user by name but no group then the primary group of that user will be chosen. If you specify a user by number and no group then the group will be nogroup.</li>
<li><strong>-g</strong> - group-id to use. Same as using:group for the -u parameter, just a different way to specify it for compatibility with other programs.</li>
<li><strong>-q</strong> - quiet mode. If specified then some of the extra informational messages will be suppressed.</li>
</ul>
<h1 id="Reference">Reference</h1><ul>
<li><a href="http://www.coker.com.au/bonnie++/" target="_blank" rel="external">Bonnie++</a></li>
<li>man bonnie++</li>
<li><a href="http://archive09.linux.com/feature/139742" target="_blank" rel="external">Using Bonnie++ for filesystem performance benchmarking</a></li>
</ul>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>





  <article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2015-04-24T00:35:18.000Z"><a href="/2015/04/24/我的emacs配置文件/">2015-04-24</a></time>
      
      
  
    <h1 class="title"><a href="/2015/04/24/我的emacs配置文件/">我的emacs配置文件</a></h1>
  

    </header>
    <div class="entry">
      
        <p>我的emacs配置文件</p>
      
    </div>
    <footer>
      
        
          <div class="alignleft">
            <a href="/2015/04/24/我的emacs配置文件/#more" class="more-link">阅读全文</a>
          </div>
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>





  <article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2015-04-24T00:35:18.000Z"><a href="/2015/04/24/我是如何写博客的/">2015-04-24</a></time>
      
      
  
    <h1 class="title"><a href="/2015/04/24/我是如何写博客的/">我是如何写博客的</a></h1>
  

    </header>
    <div class="entry">
      
        <p>每个人都有自己写博客的方式， 我来分享下我是怎么写博客的。<br>
      
    </div>
    <footer>
      
        
          <div class="alignleft">
            <a href="/2015/04/24/我是如何写博客的/#more" class="more-link">阅读全文</a>
          </div>
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>





  <article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2015-04-24T00:35:18.000Z"><a href="/2015/04/24/如何用GIMP修改图片尺寸/">2015-04-24</a></time>
      
      
  
    <h1 class="title"><a href="/2015/04/24/如何用GIMP修改图片尺寸/">如何用GIMP修改图片尺寸</a></h1>
  

    </header>
    <div class="entry">
      
        <ol>
<li><p>在 GIMP 中打开原始图片。</p>
</li>
<li><p>点击 图像 菜单选择 缩放图像…</p>
</li>
<li><p>确保宽/高比例是锁定的(链条连接)。</p>
</li>
<li><p>修改宽度或高度，是两者都符合或小于需要的图片尺寸。</p>
</li>
<li><p>点击 缩放 按钮</p>
</li>
<li><p>选择整幅图片(Ctrl + A 或点击菜单 选择 &gt; 全部 )</p>
</li>
<li><p>点击 文件 &gt; 新建，创建一个新的图片。</p>
</li>
<li><p>设置图像大小为需要的解析度</p>
</li>
<li><p>选择高级选项并设置填充透明。</p>
</li>
<li><p>点击 确定</p>
</li>
<li><p>复制重设过大小的图片内容到新创建的图片</p>
</li>
<li><p>保存新图片为 PNG 文件。</p>
</li>
</ol>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>





  <article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2015-04-24T00:35:18.000Z"><a href="/2015/04/24/wordpress-jekyll-octopress-hexo四博客引擎比较/">2015-04-24</a></time>
      
      
  
    <h1 class="title"><a href="/2015/04/24/wordpress-jekyll-octopress-hexo四博客引擎比较/">wordpress, jekyll, octopress, hexo四博客引擎比较</a></h1>
  

    </header>
    <div class="entry">
      
        <p>刚搭建起自己的博客，折腾了2天尝试过各种博客引擎， 最终选择了hexo. 这是我的第一篇博文，好吧， 就从博客说起吧 ：-）</p>
      
    </div>
    <footer>
      
        
          <div class="alignleft">
            <a href="/2015/04/24/wordpress-jekyll-octopress-hexo四博客引擎比较/#more" class="more-link">阅读全文</a>
          </div>
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>





  <article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2015-04-24T00:35:18.000Z"><a href="/2015/04/24/shell实现的windows回收站功能的脚本/">2015-04-24</a></time>
      
      
  
    <h1 class="title"><a href="/2015/04/24/shell实现的windows回收站功能的脚本/">shell实现的windows回收站功能的脚本</a></h1>
  

    </header>
    <div class="entry">
      
        <iframe src="https://www.slideshare.net/slideshow/embed_code/41359663" width="100%" height="400" frameborder="0" marginwidth="0" marginheight="0" scrolling="no"></iframe>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>





  <article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2015-04-24T00:35:18.000Z"><a href="/2015/04/24/netperf/">2015-04-24</a></time>
      
      
  
    <h1 class="title"><a href="/2015/04/24/netperf/">netperf</a></h1>
  

    </header>
    <div class="entry">
      
        <h1 id="How_to_install_netperf">How to install netperf</h1><ol>
<li><p>Download netperf from ftp://ftp.netperf.org/netperf/netperf-2.6.0.tar.gz</p>
</li>
<li><p>Install netperf from source code</p>
</li>
</ol>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># tar -xvzf netperf-xxxxx</span></span><br><span class="line"><span class="comment"># cd netperf-xxxxx</span></span><br><span class="line"><span class="comment"># ./configure --enable-burst</span></span><br><span class="line"><span class="comment"># make</span></span><br><span class="line"><span class="comment"># make install</span></span><br></pre></td></tr></table></figure>
<h1 id="Features_and_Functions">Features and Functions</h1><p>Netperf is designed around a basic client-server model. There are two executables - netperf and netserver. Generally you will only execute the netperf program, with the netserver program being invoked by the remote system’s inetd or having been previously started as its own standalone daemon.</p>
<p>When you execute netperf it will establish a “control connection” to the remote system. This connection will be used to pass test configuration information and results to and from the remote system. Regardless of the type of test to be run, the control connection will be a TCP connection using BSD sockets. The control connection can use either IPv4 or IPv6.</p>
<p>Once the control connection is up and the configuration information has been passed, a separate “data” connection will be opened for the measurement itself using the API’s and protocols appropriate for the specified test. When the test is completed, the data connection will be torn-down and results from the netserver will be passed-back via the control connection and combined with netperf’s result for display to the user.</p>
<p>Netperf places no traffic on the control connection while a test is in progress. Certain TCP options, such as SO_KEEPALIVE, if set as your systems’ default, may put packets out on the control connection while a test is in progress. Generally speaking this will have no effect on the results.</p>
<h1 id="How_to_use_netperf">How to use netperf</h1><p>For xen performance testing, we only test the following type of test:</p>
<ul>
<li><strong>TCP_STREAM</strong> - is the default test in netperf. It is quite simple, transferring some quantity of data from the system running netperf to the system running netserver.</li>
<li><strong>TCP_RR</strong> - A TCP_RR test can be thought-of as a user-space to user-space ping with no think time - it is by default a synchronous, one transaction at a time, request/response test.</li>
<li><strong>TCP_CRR</strong> - A TCP_CRR test is like a merger of a TCP_RR and TCP_CC test which measures the performance of establishing a connection, exchanging a single request/response transaction, and tearing-down that connection.</li>
<li><strong>UDP_STREAM</strong> - A UDP_STREAM test is similar to a TCP_STREAM test except UDP is used as the transport rather than TCP.</li>
<li><strong>UDP_RR</strong> - It is very much the same as a TCP_RR test except UDP is used rather than TCP.</li>
</ul>
<h2 id="Multiple_instances_of_TCP_STREAM">Multiple instances of TCP_STREAM</h2><h3 id="Test_scenarios">Test scenarios</h3><ol>
<li>Host -&gt;External Host</li>
<li>Host -&gt; Guest</li>
<li>Guest -&gt; Host</li>
<li>Guest -&gt; Guest</li>
<li>External Host -&gt; Guest</li>
<li>Guest -&gt; External Host</li>
</ol>
<p><strong>Note:</strong><br>A straight attachment link two machine<br>For secnario 5 &amp; 6 better in 10Gbit</p>
<h3 id="Command">Command</h3><ol>
<li><p>Run <code>netserver</code> on remote host</p>
</li>
<li><p>On local host, run:</p>
</li>
</ol>
<p>e.g instances = 4</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="shebang">#!/bin/bash</span></span><br><span class="line"><span class="keyword">for</span> a <span class="keyword">in</span> <span class="number">32</span> <span class="number">64</span> <span class="number">128</span> <span class="number">256</span> <span class="number">512</span> <span class="number">1024</span> <span class="number">1460</span> <span class="number">2048</span> <span class="number">4096</span> <span class="number">8192</span>  <span class="number">9000</span> <span class="number">16384</span> <span class="number">32768</span>  <span class="number">65495</span> <span class="number">65507</span></span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">    <span class="keyword">for</span> b <span class="keyword">in</span> <span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">4</span></span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">        netperf -t TCP_STREAM <span class="operator">-f</span> m -H <span class="variable">$remote_server_ip</span> -P <span class="number">0</span> <span class="operator">-l</span> <span class="number">10</span> -- -m <span class="variable">$a</span> &amp;</span><br><span class="line">    <span class="keyword">done</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>
<h2 id="Multiple_instances_of_UDP_STREAM">Multiple instances of UDP_STREAM</h2><h3 id="Test_scenarios-1">Test scenarios</h3><ol>
<li>Host -&gt;External Host</li>
<li>Host -&gt; Guest</li>
<li>Guest -&gt; Host</li>
<li>Guest -&gt; Guest</li>
<li>External Host -&gt; Guest</li>
<li>Guest -&gt; External Host</li>
</ol>
<p><strong>Note:</strong><br>A straight attachment link two machine<br>For secnario 5 &amp; 6 better in 10Gbit</p>
<h3 id="Command-1">Command</h3><ol>
<li><p>Run <code>netserver</code> on remote host</p>
</li>
<li><p>On local host, run:</p>
</li>
</ol>
<p>e.g instances = 4</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="shebang">#!/bin/bash</span></span><br><span class="line"><span class="keyword">for</span> a <span class="keyword">in</span> <span class="number">32</span> <span class="number">64</span> <span class="number">128</span> <span class="number">256</span> <span class="number">512</span> <span class="number">1024</span> <span class="number">1460</span> <span class="number">2048</span> <span class="number">4096</span> <span class="number">8192</span>  <span class="number">9000</span> <span class="number">16384</span> <span class="number">32768</span>  <span class="number">65495</span> <span class="number">65507</span></span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">    <span class="keyword">for</span> b <span class="keyword">in</span> <span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">4</span></span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">        netperf -t UDP_STREAM <span class="operator">-f</span> m -H <span class="variable">$remote_server_ip</span> -P <span class="number">0</span> <span class="operator">-l</span> <span class="number">10</span> -- -m <span class="variable">$a</span> &amp;</span><br><span class="line">    <span class="keyword">done</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>
<h2 id="Multiple_instances_of_TCP_RR">Multiple instances of TCP_RR</h2><h3 id="Test_scenarios-2">Test scenarios</h3><ol>
<li>Host -&gt;External Host</li>
<li>Host -&gt; Guest</li>
<li>Guest -&gt; Host</li>
<li>Guest -&gt; Guest</li>
<li>External Host -&gt; Guest</li>
<li>Guest -&gt; External Host</li>
</ol>
<p><strong>Note:</strong><br>A straight attachment link two machine<br>For secnario 5 &amp; 6 better in 10Gbit</p>
<h3 id="Command-2">Command</h3><ol>
<li><p>Run <code>netserver</code> on remote host</p>
</li>
<li><p>On local host, run:</p>
</li>
</ol>
<p>e.g instances = 1/25/50/100</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> b <span class="keyword">in</span> <span class="number">1</span> <span class="number">25</span> <span class="number">50</span> <span class="number">100</span></span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">    netperf -v <span class="number">0</span> -P <span class="number">0</span> -t TCP_RR -B <span class="string">": VM1 -b <span class="variable">$b</span> -r 256,256"</span> -H <span class="variable">$remote_server_ip</span> -- -r <span class="number">256</span>,<span class="number">256</span> -b <span class="variable">$b</span> -D</span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>
<h2 id="Multiple_instances_of_UDP_RR">Multiple instances of UDP_RR</h2><h3 id="Test_scenarios-3">Test scenarios</h3><ol>
<li>Host -&gt;External Host</li>
<li>Host -&gt; Guest</li>
<li>Guest -&gt; Host</li>
<li>Guest -&gt; Guest</li>
<li>External Host -&gt; Guest</li>
<li>Guest -&gt; External Host</li>
</ol>
<p><strong>Note:</strong><br>A straight attachment link two machine<br>For secnario 5 &amp; 6 better in 10Gbit</p>
<h3 id="Command-3">Command</h3><ol>
<li><p>Run <code>netserver</code> on remote host</p>
</li>
<li><p>On local host, run:</p>
</li>
</ol>
<p>e.g instances = 1/25/50/100</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> b <span class="keyword">in</span> <span class="number">1</span> <span class="number">25</span> <span class="number">50</span> <span class="number">100</span></span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">    netperf -v <span class="number">0</span> -P <span class="number">0</span> -t UDP_RR -B <span class="string">": VM1 -b <span class="variable">$b</span> -r 256,256"</span> -H <span class="variable">$remote_server_ip</span> -- -r <span class="number">256</span>,<span class="number">256</span> -b <span class="variable">$b</span> -D</span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>
<h2 id="Multiple_instances_of_TCP_CRR">Multiple instances of TCP_CRR</h2><h3 id="Test_scenarios-4">Test scenarios</h3><ol>
<li>Host -&gt;External Host</li>
<li>Host -&gt; Guest</li>
<li>Guest -&gt; Host</li>
<li>Guest -&gt; Guest</li>
<li>External Host -&gt; Guest</li>
<li>Guest -&gt; External Host</li>
</ol>
<p><strong>Note:</strong><br>A straight attachment link two machine<br>For secnario 5 &amp; 6 better in 10Gbit</p>
<h3 id="Command-4">Command</h3><ol>
<li><p>Run <code>netserver</code> on remote host</p>
</li>
<li><p>On local host, run:</p>
</li>
</ol>
<p>e.g instances = 1/25/50/100</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> b <span class="keyword">in</span> <span class="number">1</span> <span class="number">25</span> <span class="number">50</span> <span class="number">100</span></span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">    netperf -v <span class="number">0</span> -P <span class="number">0</span> -t TCP_CRR  -H <span class="variable">$remote_server_ip</span> -- -r <span class="number">256</span>,<span class="number">256</span> -b <span class="number">1</span> -D</span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>
<p><strong>Note:</strong> There also some example scripts used to test TCP_STREAM, TCP_RR, UDP_STREAM, UDP_RR under netperf-xxxxx/doc/examples/, you can modify it as necessary.</p>
<h1 id="Results_analysis">Results analysis</h1><h2 id="For_TCP_STREAM_test">For TCP_STREAM test</h2><p>The results will be in the following format:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">87380</span>  <span class="number">16384</span>     <span class="number">64</span>    <span class="number">10.00</span>     <span class="number">688.1</span></span><br></pre></td></tr></table></figure>
<ul>
<li><strong>the first field</strong> - remote (netserver) send and/or receive socket buffer sizes for the data connection.</li>
<li><strong>the second field</strong> - local (netperf) send and receive socket buffer sizes for the data connection.</li>
<li><strong>the third field</strong> - the size of the buffer passed-in to the “send” calls of a _STREAM test.</li>
<li><strong>the fourth field</strong> - the  length  of  the  test (default 10 seconds).</li>
<li><strong>the fifth field</strong> - Throughput</li>
</ul>
<p>We should focus on the <strong>Throughput</strong>, the larger the better.</p>
<h2 id="For_UDP_STREAM_test">For UDP_STREAM test</h2><p>The results will be in the following format:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">212992</span>      <span class="number">64</span>   <span class="number">10.00</span>      <span class="number">659319</span>      <span class="number">0</span>      <span class="number">33.76</span></span><br><span class="line"><span class="number">212992</span>           <span class="number">10.00</span>      <span class="number">610884</span>             <span class="number">31.28</span></span><br></pre></td></tr></table></figure>
<p>The first line is the results of local host.<br>The second is the results of remote server.</p>
<ul>
<li><strong>the first field</strong> - remote (netserver) send and/or receive socket buffer sizes for the data connection.</li>
<li><strong>the second field</strong> - local (netperf) send and receive socket buffer sizes for the data connection.</li>
<li><strong>the third field</strong> - the size of the buffer passed-in to the “send” calls of a _STREAM test.</li>
<li><strong>the fourth field</strong> - the  length  of  the  test (default 10 seconds).</li>
<li><strong>the fifth field</strong> - Throughput</li>
</ul>
<p>We should focus on the <strong>Throughput</strong>, the larger the better.</p>
<h2 id="For_TCP_RR_test">For TCP_RR test</h2><p>The results will be in the following format:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">31464.49</span> : VM1 -<span class="number">25</span>  -r <span class="number">256</span>,<span class="number">256</span></span><br></pre></td></tr></table></figure>
<ul>
<li><strong>the first field</strong> - Transaction rate</li>
</ul>
<p>We should focus on the <strong>Transaction rate</strong>, the larger the better.</p>
<h2 id="For_TCP_CRR">For TCP_CRR</h2><p>The results will be in the following format:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">151.40</span></span><br></pre></td></tr></table></figure>
<ul>
<li><strong>the first field</strong> - Transaction rate</li>
</ul>
<p>We should focus on the <strong>Transaction rate</strong>, the larger the better.</p>
<h2 id="For_UDP_RR">For UDP_RR</h2><p>The results will be in the following format:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">33748.49</span> : VM1 -b  -r <span class="number">256</span>,<span class="number">256</span></span><br></pre></td></tr></table></figure>
<ul>
<li><strong>the first field</strong> - Transaction rate</li>
</ul>
<p>We should focus on the <strong>Transaction rate</strong>, the larger the better.</p>
<h1 id="The_main_parameters">The main parameters</h1><p>Netperf command format:</p>
<ol>
<li><p>sets both global and test-specific options:<br><code>netperf &lt;global&gt; -- &lt;test-specific&gt;</code></p>
</li>
<li><p>sets just global options and:<br><code>netperf &lt;global&gt;</code></p>
</li>
<li><p>sets just global options and:<br><code>netperf -- &lt;test-specific&gt;</code></p>
</li>
</ol>
<h2 id="Global_Options">Global Options</h2><ul>
<li><strong>-B <string></string></strong> - This option will cause <string> to be appended to the brief (see -P) output of netperf.</string></li>
<li><strong>-H name|ip</strong> - Set the hostname (or IP address) and address family to use to establish the control connection to the remote system.</li>
<li><strong>-b <size></size></strong> - This option is only present when netperf has been configure with –enable-intervals=yes prior to compilation. It sets the size of the burst of send calls in a _STREAM test. When used in conjunction with the -w option it can cause the rate at which data is sent to be “paced.”</li>
<li><strong>-i <sizespec></sizespec></strong> - This option enables the calculation of confidence intervals and sets the minimum and maximum number of iterations to run in attempting to achieve the desired confidence interval.</li>
<li><strong>-t testname</strong> - Specify the test to perform. As of this writing, valid values for testname include:<ul>
<li><strong>TCP_STREAM</strong>, TCP_MAERTS, TCP_SENDFILE, <strong>TCP_RR</strong>, <strong>TCP_CRR</strong>, TCP_CC</li>
<li><strong>UDP_STREAM</strong>, <strong>UDP_RR</strong></li>
<li>XTI_TCP_STREAM, XTI_TCP_RR, XTI_TCP_CRR, XTI_TCP_CC</li>
<li>XTI_UDP_STREAM, XTI_UDP_RR</li>
<li>SCTP_STREAM, SCTP_RR</li>
<li>DLCO_STREAM, DLCO_RR, DLCL_STREAM, DLCL_RR</li>
<li>LOC_CPU, REM_CPU</li>
<li>OMNI</li>
</ul>
</li>
<li><strong>-l testlen</strong> - Specify  the  length  of  the  test (default 10 seconds).</li>
<li><strong>-4</strong> - Use AF_INET (aka IPv4) addressing for the control and possibly data connections.</li>
<li><strong>-6</strong> - Use AF_INET6 (aka IPv6) addressing for the control and possibly data connections.</li>
<li><strong>-v verbosity</strong> - This option controls how verbose netperf will be in its output, and is often used in conjunction with the -P option.</li>
<li><strong>-P 0|1</strong> - A value of “1” for the -P option will enable display of the test banner. A value of “0” will disable display of the test banner.</li>
</ul>
<h2 id="Test_Specific_Options(TCP_STREAM,_UDP_STREAM)">Test Specific Options(TCP_STREAM, UDP_STREAM)</h2><ul>
<li><strong>-s <sizespec></sizespec></strong> - This option sets the local (netperf) send and receive socket buffer sizes for the data connection to the value(s) specified. Often, this will affect the advertised and/or effective TCP or other window, but on some platforms it may not. By default the units are bytes, but suffix of “G,” “M,” or “K” will specify the units to be 2^30 (GB), 2^20 (MB) or 2^10 (KB) respectively. A suffix of “g,” “m” or “k” will specify units of 10^9, 10^6 or 10^3 bytes respectively.</li>
<li><strong>-S <sizespec></sizespec></strong> - This option sets the remote (netserver) send and/or receive socket buffer sizes for the data connection to the value(s) specified. Often, this will affect the advertised and/or effective TCP or other window, but on some platforms it may not. By default the units are bytes, but suffix of “G,” “M,” or “K” will specify the units to be 2^30 (GB), 2^20 (MB) or 2^10 (KB) respectively. A suffix of “g,” “m” or “k” will specify units of 10^9, 10^6 or 10^3 bytes respectively.</li>
<li><strong>-m bytes</strong> - Set the size of the buffer passed-in to the “send” calls of a <em>STREAM test. Note that this may have only an indirect effect on the size of the packets sent over the network, and certain Layer 4 protocols do _not</em> preserve or enforce message boundaries, so setting -m for the send size does not necessarily mean the receiver will receive that many bytes at any one time. By default the units are bytes, but suffix of “G,” “M,” or “K” will specify the units to be 2^30 (GB), 2^20 (MB) or 2^10 (KB) respectively. A suffix of “g,” “m” or “k” will specify units of 10^9, 10^6 or 10^3 bytes respectively.</li>
<li><strong>-M bytes</strong> - Set the size of the buffer passed-in to the “recv” calls of a _STREAM test. This will be an upper bound on the number of bytes received per receive call. By default the units are bytes, but suffix of “G,” “M,” or “K” will specify the units to be 2^30 (GB), 2^20 (MB) or 2^10 (KB) respectively. A suffix of “g,” “m” or “k” will specify units of 10^9, 10^6 or 10^3 bytes respectively.</li>
<li><strong>-D</strong> - This option will set TCP_NODELAY on the data connection on those systems where TCP_NODELAY is defined. This disables something known as the Nagle Algorithm, which is intended to make the segments TCP sends as large as reasonably possible.</li>
</ul>
<h2 id="Test_Specific_Options(TCP_RR,_TCP_CRR,_UDP_RR)">Test Specific Options(TCP_RR, TCP_CRR, UDP_RR)</h2><ul>
<li><strong>-r <sizespec></sizespec></strong> - This option sets the request (first value) and/or response (second value) sizes for an _RR test. By default the units are bytes, but a suffix of “G,” “M,” or “K” will specify the units to be 2^30 (GB), 2^20 (MB) or 2^10 (KB) respectively. A suffix of “g,” “m” or “k” will specify units of 10^9, 10^6 or 10^3 bytes respectively.</li>
<li><strong>-s <sizespec></sizespec></strong> - This option sets the local (netperf) send and receive socket buffer sizes for the data connection to the value(s) specified. Often, this will affect the advertised and/or effective TCP or other window, but on some platforms it may not. By default the units are bytes, but a suffix of “G,” “M,” or “K” will specify the units to be 2^30 (GB), 2^20 (MB) or 2^10 (KB) respectively. A suffix of “g,” “m” or “k” will specify units of 10^9, 10^6 or 10^3 bytes respectively.</li>
<li><strong>-S <sizespec></sizespec></strong> - This option sets the remote (netserver) send and/or receive socket buffer sizes for the data connection to the value(s) specified. Often, this will affect the advertised and/or effective TCP or other window, but on some platforms it may not. By default the units are bytes, but a suffix of “G,” “M,” or “K” will specify the units to be 2^30 (GB), 2^20 (MB) or 2^10 (KB) respectively. A suffix of “g,” “m” or “k” will specify units of 10^9, 10^6 or 10^3 bytes respectively.</li>
<li><strong>-D</strong> - This option will set TCP_NODELAY on the data connection on those systems where TCP_NODELAY is defined. This disables something known as the Nagle Algorithm, which is intended to make the segments TCP sends as large as reasonably possible.</li>
</ul>
<h1 id="Reference">Reference</h1><ul>
<li><a href="http://www.netperf.org/svn/netperf2/tags/netperf-2.6.0/doc/netperf.html" target="_blank" rel="external">netperf manual</a></li>
<li><a href="http://www.netperf.org/netperf/" target="_blank" rel="external">Welcome to the Netperf Homepage</a></li>
</ul>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>





  <article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2015-04-24T00:35:18.000Z"><a href="/2015/04/24/nbench/">2015-04-24</a></time>
      
      
  
    <h1 class="title"><a href="/2015/04/24/nbench/">nbench</a></h1>
  

    </header>
    <div class="entry">
      
        <h1 id="How_to_install_nbench">How to install nbench</h1><ol>
<li><p>Download nbench from: <a href="http://www.tux.org/~mayer/linux/nbench-byte-2.2.3.tar.gz" target="_blank" rel="external">http://www.tux.org/~mayer/linux/nbench-byte-2.2.3.tar.gz</a></p>
</li>
<li><p>Extract and install it:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># tar -xvzf nbench-byte-XXXX.tar.gz</span></span><br><span class="line"><span class="comment"># cd nbench-byte-XXXX</span></span><br><span class="line"><span class="comment"># make</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<p><strong>Note:</strong> You need to install glibc-static package on your guest.</p>
<h1 id="Features_and_Functions">Features and Functions</h1><ul>
<li>Numeric sort - Sorts an array of long integers.</li>
<li>String sort - Sorts an array of strings of arbitrary length.</li>
<li>Bitfield - Executes a variety of bit manipulation functions.</li>
<li>Emulated floating-point - A small software floating-point package.</li>
<li>Fourier coefficients - A numerical analysis routine for calculating series approximations of waveforms.</li>
<li>Assignment algorithm - A well-known task allocation algorithm.</li>
<li>Huffman compression - A well-known text and graphics compression algorithm.</li>
<li>IDEA encryption - A relatively new block cipher algorithm.</li>
<li>Neural Net - A small but functional back-propagation network simulator.</li>
<li>LU Decomposition - A robust algorithm for solving linear equations.</li>
</ul>
<p>A run of the benchmark suite consists essentially of two phases for each of the tests. First, a calibration loop is run to determine the size of the problem the system can handle in a reasonable time, in order to adapt to the ever faster computer hardware available. Second, the actual test is run repeatedly several times to obtain a statistically meaningful result.</p>
<p>Originally, NBench and BYTEmark produced two overall index figures: Integer index and Floating-point index. The Integer index is the geometric mean of those tests that involve only integer processing—numeric sort, string sort, bitfield, emulated floating-point, assignment, Huffman, and IDEA—while the Floating-point index is the geometric mean of those tests that require the floating-point coprocessor—Fourier, neural net, and LU decomposition. The index figures where relative scores to get a general feel for the performance of the machine under test as compared to a baseline system based on a 90 MHz Pentium Intel CPU.</p>
<p>The Linux/Unix port has a second baseline machine, it is an AMD K6/233 with 32 MB RAM and 512 KB L2-cache running Linux 2.0.32 and using GNU gcc version 2.7.2.3 and libc-5.4.38. The original integer index was split into an integer-operation and a memory-operation index, as suggested by Andrew D. Balsa, reflecting the realization that memory management is important in CPU design. The original tests have been left alone, however, the geometric mean of the tests numeric sort, floating-point emulation, IDEA, and Huffman now constitutes the integer-arithmetic focused benchmark index, while the geometric mean of the tests string sort, bitfield, and assignment makes up the new memory index. The floating point index has been left alone, it is still the geometric mean of fourier, neural net, and LU decomposition.</p>
<h1 id="How_to_use_nbench">How to use nbench</h1><p>nbench is very easy to run, just issue command <code>./nbench</code> and take a cup of coffee to wait the results.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># cd nbench-byte-XXXX</span></span><br><span class="line"><span class="comment"># ./nbench</span></span><br><span class="line"></span><br><span class="line">BYTEmark* Native Mode Benchmark ver. <span class="number">2</span> (<span class="number">10</span>/<span class="number">95</span>)</span><br><span class="line">Index-split by Andrew D. Balsa (<span class="number">11</span>/<span class="number">97</span>)</span><br><span class="line">Linux/Unix* port by Uwe F. Mayer (<span class="number">12</span>/<span class="number">96</span>,<span class="number">11</span>/<span class="number">97</span>)</span><br><span class="line"></span><br><span class="line">TEST                : Iterations/sec.  : Old Index   : New Index</span><br><span class="line">                    :                  : Pentium <span class="number">90</span>* : AMD K6/<span class="number">233</span>*</span><br><span class="line">--------------------:------------------:-------------:------------</span><br><span class="line">NUMERIC SORT        :          <span class="number">1274.9</span>  :      <span class="number">32.69</span>  :      <span class="number">10.74</span></span><br><span class="line">STRING SORT         :          <span class="number">545.29</span>  :     <span class="number">243.65</span>  :      <span class="number">37.71</span></span><br><span class="line">BITFIELD            :      <span class="number">3.9117</span>e+<span class="number">08</span>  :      <span class="number">67.10</span>  :      <span class="number">14.02</span></span><br><span class="line">FP EMULATION        :          <span class="number">195.95</span>  :      <span class="number">94.03</span>  :      <span class="number">21.70</span></span><br><span class="line">FOURIER             :           <span class="number">24257</span>  :      <span class="number">27.59</span>  :      <span class="number">15.49</span></span><br><span class="line">ASSIGNMENT          :          <span class="number">30.302</span>  :     <span class="number">115.30</span>  :      <span class="number">29.91</span></span><br><span class="line">IDEA                :          <span class="number">5556.7</span>  :      <span class="number">84.99</span>  :      <span class="number">25.23</span></span><br><span class="line">HUFFMAN             :          <span class="number">2032.3</span>  :      <span class="number">56.36</span>  :      <span class="number">18.00</span></span><br><span class="line">NEURAL NET          :           <span class="number">59.18</span>  :      <span class="number">95.07</span>  :      <span class="number">39.99</span></span><br><span class="line">LU DECOMPOSITION    :          <span class="number">1486.4</span>  :      <span class="number">77.00</span>  :      <span class="number">55.60</span></span><br><span class="line">==========================ORIGINAL BYTEMARK RESULTS==========================</span><br><span class="line">INTEGER INDEX       : <span class="number">83.268</span></span><br><span class="line">FLOATING-POINT INDEX: <span class="number">58.668</span></span><br><span class="line">Baseline (MSDOS*)   : Pentium* <span class="number">90</span>, <span class="number">256</span> KB L2-cache, Watcom* compiler <span class="number">10.0</span></span><br><span class="line">==============================LINUX DATA BELOW===============================</span><br><span class="line">CPU                 : <span class="number">4</span> CPU GenuineIntel Intel(R) Xeon(R) CPU           E5620  @ <span class="number">2.40</span>GHz <span class="number">2394</span>MHz</span><br><span class="line">L2 Cache            : <span class="number">12288</span> KB</span><br><span class="line">OS                  : Linux <span class="number">3.10</span>.<span class="number">0</span>-<span class="number">229</span>.el7.x86_64</span><br><span class="line">C compiler          : gcc version <span class="number">4.8</span>.<span class="number">3</span> <span class="number">20140911</span> (Red Hat <span class="number">4.8</span>.<span class="number">3</span>-<span class="number">9</span>) (GCC)</span><br><span class="line">libc                : libc-<span class="number">2.17</span>.so</span><br><span class="line">MEMORY INDEX        : <span class="number">25.097</span></span><br><span class="line">INTEGER INDEX       : <span class="number">18.035</span></span><br><span class="line">FLOATING-POINT INDEX: <span class="number">32.539</span></span><br><span class="line">Baseline (LINUX)    : AMD K6/<span class="number">233</span>*, <span class="number">512</span> KB L2-cache, gcc <span class="number">2.7</span>.<span class="number">2.3</span>, libc-<span class="number">5.4</span>.<span class="number">38</span></span><br><span class="line">* Trademarks are property of their respective holder.</span><br></pre></td></tr></table></figure>
<h1 id="Results_analysis">Results analysis</h1><p>There are three performance indicators: <strong>MEMORY INDEX</strong>, <strong>INTEGER INDEX</strong>, <strong>FLOATING-POINT INDEX</strong>, for these indicators the larger the better.</p>
<p><strong>MEMORY INDEX</strong> - The performance of front-side bus (FSB) and cpu cache size.<br><strong>INTEGER INDEX</strong> - Integer processing performance.<br><strong>FLOATING-POINT INDEX</strong> - Double-precision floating-point processing performance.</p>
<p><strong>Note:</strong> There is a <em>RESULTS</em> file under nbench-byte-XXXX, you can compare your results with the results in the <em>RESULTS</em> file.</p>
<h1 id="The_main_parameters">The main parameters</h1><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ./nbench -h</span></span><br><span class="line">Usage: ./nbench [-v] [-c&lt;FILE&gt;]</span><br><span class="line"> -v = verbose</span><br><span class="line"> -c = input parameters thru <span class="built_in">command</span> file &lt;FILE&gt;</span><br></pre></td></tr></table></figure>
<p>You see, nbench is very easy to use.</p>
<h1 id="Shortcomings">Shortcomings</h1><ul>
<li>These benchmarks are meant to expose the theoretical upper limit of the CPU, FPU, and memory architecture of a system. They cannot measure video, disk, or network throughput (those are the domains of a different set of benchmarks).</li>
<li>NBench is single-threaded. Currently, each benchmark test uses only a single execution thread. However, most modern operating systems have some multitasking component. How a system “scales” as more tasks are run simultaneously is an effect that NBench does not explore.</li>
</ul>
<h1 id="Reference">Reference</h1><ul>
<li><a href="http://www.tux.org/~mayer/linux/bmark.html" target="_blank" rel="external">Linux/Unix NBench</a></li>
<li><a href="http://www.tux.org/~mayer/linux/byte/bdoc.pdf" target="_blank" rel="external">Original NBench documentation (archived snapshot)</a></li>
<li><a href="http://www.tux.org/~mayer/linux/results2.html" target="_blank" rel="external">NBench Results</a></li>
</ul>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>





  <article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2015-04-24T00:35:18.000Z"><a href="/2015/04/24/markdown-语法简记/">2015-04-24</a></time>
      
      
  
    <h1 class="title"><a href="/2015/04/24/markdown-语法简记/">markdown 语法简记</a></h1>
  

    </header>
    <div class="entry">
      
        <p>很简介的markdown语法说明，适合快速入门markdown<br>
      
    </div>
    <footer>
      
        
          <div class="alignleft">
            <a href="/2015/04/24/markdown-语法简记/#more" class="more-link">阅读全文</a>
          </div>
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>






<nav id="pagination">
  
  
    <a href="/page/2/" class="alignright next">下一页</a>
  
  <div class="clearfix"></div>
</nav></div></div>
    <aside id="sidebar" class="alignright">
  <div class="search">
  <form action="//google.com/search" method="get" accept-charset="utf-8">
    <input type="search" name="q" results="0" placeholder="搜索">
    <input type="hidden" name="q" value="site:konglf.github.com">
  </form>
</div>

  
<div class="widget tag">
  <h3 class="title">分类</h3>
  <ul class="entry">
  
    <li><a href="/categories/Technology/Emacs/">Emacs</a><small>1</small></li>
  
    <li><a href="/categories/Technology/Keys/">Keys</a><small>2</small></li>
  
    <li><a href="/categories/Technology/Lex/">Lex</a><small>2</small></li>
  
    <li><a href="/categories/Technology/Linux/">Linux</a><small>1</small></li>
  
    <li><a href="/categories/essay/Linux/">Linux</a><small>1</small></li>
  
    <li><a href="/categories/Technology/Python/">Python</a><small>2</small></li>
  
    <li><a href="/categories/Technology/Shell/">Shell</a><small>1</small></li>
  
    <li><a href="/categories/Technology/">Technology</a><small>30</small></li>
  
    <li><a href="/categories/Technology/Xen/Virtualization/">Virtualization</a><small>1</small></li>
  
    <li><a href="/categories/Technology/Xen/">Xen</a><small>1</small></li>
  
    <li><a href="/categories/essay/">essay</a><small>3</small></li>
  
  </ul>
</div>


  <div class="widget tag">
<h3 class="title">简介</h3>
<ul class="entry">
<li>中文名：孔令飞</li>
<li>英文名：Alex</li>
<li>现状：Lenovo从事存储性能调优</li>
<li>QQ号：466701708</li>
<li>想要交友的朋友请<a href="http://konglf.github.io/about">联系我</a>！</li>
<li><a href="http://chenghongjie1.sinaapp.com/">I Love You!</a></li>
</ul>
</div>


  <iframe width="100%" height="550" class="share_self"  frameborder="0" scrolling="no" src="http://widget.weibo.com/weiboshow/index.php?language=&width=0&height=550&fansRow=2&ptype=1&speed=0&skin=1&isTitle=1&noborder=1&isWeibo=1&isFans=1&uid=3768665395&verifier=bc944b64&dpc=1"></iframe>

</aside>
    <div class="clearfix"></div>
  </div>
  <footer id="footer" class="inner"><div class="alignleft">
  
  &copy; 2015 Lingfei Kong
  
</div>
<div class="clearfix"></div></footer>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>




<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>

</body>
</html>


<a href="https://github.com/alex8866" target="_blank"><img style="position: absolute; top: 0; left: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_left_white_ffffff.png" alt="Fork me on GitHub"></a>
